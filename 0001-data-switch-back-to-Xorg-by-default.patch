From 101dc244a6f77acbae1c5c2e60665810ed295476 Mon Sep 17 00:00:00 2001
From: Ray Strode <rstrode@redhat.com>
Date: Mon, 7 Mar 2016 13:36:32 -0500
Subject: [PATCH] data: switch back to Xorg by default

Consensus seems to be that switching to wayland for user sessions
by default is a bit premature.

This commit moves it back to Xorg by default.

We'll save wayland by default for 3.22

https://bugzilla.gnome.org/show_bug.cgi?id=763266
---
 data/Makefile.am              | 4 ++--
 data/gnome-wayland.desktop.in | 8 ++++++++
 data/gnome-xorg.desktop.in    | 8 --------
 3 files changed, 10 insertions(+), 10 deletions(-)
 create mode 100644 data/gnome-wayland.desktop.in
 delete mode 100644 data/gnome-xorg.desktop.in

diff --git a/data/Makefile.am b/data/Makefile.am
index a171dfc..410988e 100644
--- a/data/Makefile.am
+++ b/data/Makefile.am
@@ -1,54 +1,54 @@
 SUBDIRS = icons
 
 uidir = $(pkgdatadir)
 ui_DATA = \
 	session-properties.ui
 
 if BUILD_SESSION_SELECTOR
 ui_DATA += session-selector.ui
 endif
 
 hwcompatdir = $(pkgdatadir)
 hwcompat_DATA = hardware-compatibility
 
 xsessiondir = $(datadir)/xsessions
-xsession_in_files = gnome.desktop.in gnome-xorg.desktop.in
+xsession_in_files = gnome.desktop.in
 
 if BUILD_SESSION_SELECTOR
 xsession_in_files += gnome-custom-session.desktop.in
 endif
 
 xsession_DATA = $(xsession_in_files:.desktop.in=.desktop)
 
 wayland_sessiondir = $(datadir)/wayland-sessions
-wayland_session_in_files = gnome.desktop.in
+wayland_session_in_files = gnome-wayland.desktop.in
 wayland_session_DATA = $(wayland_session_in_files:.desktop.in=.desktop)
 
 sessiondir = $(datadir)/gnome-session/sessions
 session_in_in_files = gnome.session.desktop.in.in gnome-dummy.session.desktop.in.in
 session_in_files = $(session_in_in_files:.session.desktop.in.in=.session.desktop.in)
 session_DATA = $(session_in_files:.session.desktop.in=.session)
 
 %.session.desktop.in: %.session.desktop.in.in Makefile
 	$(AM_V_GEN)sed \
 		-e "s|\@LIBEXECDIR\@|$(libexecdir)|" \
 		$< > $@
 
 %.session: %.session.desktop.in   $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; LC_ALL=C $(INTLTOOL_MERGE) -d -u -c $(top_builddir)/po/.intltool-merge-cache $(top_srcdir)/po $< $@
 
 @INTLTOOL_DESKTOP_RULE@
 @INTLTOOL_XML_NOMERGE_RULE@
 
 gsettings_SCHEMAS = org.gnome.SessionManager.gschema.xml
 @GSETTINGS_RULES@
 
 migrationdir = $(datadir)/GConf/gsettings
 dist_migration_DATA = gnome-session.convert
 
 EXTRA_DIST =					\
 	$(xsession_in_files)			\
 	$(session_in_in_files)			\
 	$(wayland_session_in_files)		\
 	$(gsettings_SCHEMAS:.xml=.xml.in)	\
 	session-selector.ui			\
 	gnome-custom-session.desktop.in		\
diff --git a/data/gnome-wayland.desktop.in b/data/gnome-wayland.desktop.in
new file mode 100644
index 0000000..852be87
--- /dev/null
+++ b/data/gnome-wayland.desktop.in
@@ -0,0 +1,8 @@
+[Desktop Entry]
+_Name=GNOME on Wayland
+_Comment=This session logs you into GNOME
+Exec=gnome-session
+TryExec=gnome-session
+Icon=
+Type=Application
+DesktopNames=GNOME
diff --git a/data/gnome-xorg.desktop.in b/data/gnome-xorg.desktop.in
deleted file mode 100644
index d00b3dc..0000000
--- a/data/gnome-xorg.desktop.in
+++ /dev/null
@@ -1,8 +0,0 @@
-[Desktop Entry]
-_Name=GNOME on Xorg
-_Comment=This session logs you into GNOME
-Exec=gnome-session
-TryExec=gnome-session
-Icon=
-Type=Application
-DesktopNames=GNOME
-- 
2.7.0

